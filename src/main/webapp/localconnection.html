<html>
<head>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script
	src="./js/scipts.js"></script>

<Script>


	$(document).ready(function() {
		
		genrateLeftSlidebar();
		var sConnectionId = getUrlParameter('connectionid');
	
		if(typeof sConnectionId  !== "undefined")
		{
			getConnectionById(sConnectionId);
		}
		/*
		var connectionMode="Update";
		
		if(connectionMode=="Update"){
			var iConnectionId=3;
			$("input[name='connectionId']").val(iConnectionId);
			$("button[name='saveLocalConnection']").attr("name","updateLocalConnection");
			getConnectionById(iConnectionId);
		}
	*/
	});
	
	
	$(document).on("click",".local_group_name",function(){
		var iconclass=$(this).find("span").attr("class");
		if(iconclass=="glyphicon glyphicon-folder-open"){$(this).find("span").attr("class","glyphicon glyphicon-folder-close");
		$(this).siblings(".list-group").hide();}
		else{$(this).find("span").attr("class","glyphicon glyphicon-folder-open");$(this).siblings(".list-group").show();}
	});
	//span[name='']
	$(document).on("click","span[name='collapse']",function(){
		var iconclass=$(this).attr("class");
		if(iconclass=="glyphicon glyphicon-plus"){
			$(this).attr("class","glyphicon glyphicon-minus");
		}
		else{
			$(this).attr("class","glyphicon glyphicon-plus");
		}
	});
	
function getConnectionById(iConnectionId){
		
		$.ajax({
			type : "post",
			url : "databaseoperations.do",
			data : "type=getConnectionById&values="+ iConnectionId ,
			success : function(response) {
				jsonObject= JSON.parse(response);
				if(jsonObject.result=="success"){
					connectionData=jsonObject.data;
					$("#connectionname").val(connectionData.connectionName);
					 $("#host").val(connectionData.hostname);
					 $("#port").val(connectionData.portNo);
					 $("#username").val(connectionData.username);
					 $("#Password").val(connectionData.password);
					 
				}
			},
			dataType : 'text'
			});
	};

	
$(document).on("click","button[name='saveLocalConnection']",function(){
			var localConnectionInformation = new Object();
			localConnectionInformation.connectionName = $("#connectionname").val();
			localConnectionInformation.hostname  = $("#host").val();
			localConnectionInformation.portNo = $("#port").val();
			localConnectionInformation.username=$("#username").val();
			localConnectionInformation.password=$("#Password").val();
			localConnectionInformation.connectionType="local";
			var jsonlocalConnectionInformation= JSON.stringify(localConnectionInformation);
			
			$.ajax({
				type : "post",
				url : "databaseoperations.do",
				data : "type=insertConnection&values="+ jsonlocalConnectionInformation ,
				success : function(response) {
					alert(response);
				},
				dataType : 'text'
				});
		});
		
		
		$(document).on("click","button[name='updateLocalConnection']",function(){
			var localConnectionInformation = new Object();
			localConnectionInformation.id = $("input[name='connectionId']").val();
			localConnectionInformation.connectionName = $("#connectionname").val();
			localConnectionInformation.hostname  = $("#host").val();
			localConnectionInformation.portNo = $("#port").val();
			localConnectionInformation.username=$("#username").val();
			localConnectionInformation.password=$("#Password").val();
			localConnectionInformation.connectionType="local";
			var jsonlocalConnectionInformation= JSON.stringify(localConnectionInformation);
			
			$.ajax({
				type : "post",
				url : "databaseoperations.do",
				data : "type=updateConnection&values="+ jsonlocalConnectionInformation ,
				success : function(response) {
					alert(response);
				},
				dataType : 'text'
				});
		});
	
		$(document).on("click","button[name='deleteLocalConnection']",function(){
			var iConnectionId=$("input[name='connectionId']").val();
			$.ajax({
				type : "post",
				url : "databaseoperations.do",
				data : "type=deleteConnection&values="+ iConnectionId,
				success : function(response) {
					alert(response);
				},
				dataType : 'text'
				});
		});
	
		
	function getUrlParameter(sParam) {
		    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
		        sURLVariables = sPageURL.split('&'),
		        sParameterName,
		        i;

		    for (i = 0; i < sURLVariables.length; i++) {
		        sParameterName = sURLVariables[i].split('=');

		        if (sParameterName[0] === sParam) {
		            return sParameterName[1] === undefined ? true : sParameterName[1];
		        }
		    }
		};
		
		
		
		
		
		
	
</Script>

<style>
 .connection_group{
	margin-top: 10px;
	margin-left: 10px;
 }
 
 .local_group_name{
	cursor:pointer;
 }
 
 [name="group-names"]{
	display:none;
 }
 
 span[name="collapse"]{
	cursor:pointer;
 }
 
 span[name="edit-connection"]{
	cursor:pointer;
 }
</style>

</head>

<body style="margin: 10px;">

	<div id="menu" style="width: 300px; float: left; margin-right: 50px">
		<h4>Local Database</h4>
		<ul name="leftSlideBar" class="list-group">
		
			<li class="list-group-item">
				<div class="group_operation">
				
				<span data-toggle="collapse"
					data-target="#gps_group" class="glyphicon glyphicon-plus" name="collapse"></span><a href="localconnection.html"><span
					class="glyphicon glyphicon-wrench" name="edit-connection"></span></a> gps
				</div>			
			<div id="gps_group" class="connection_group collapse">
					<div class="local_group_name">
						<span class="glyphicon glyphicon-folder-close"></span> Groups 
					</div>
					
					<ul  name="group-names" class="list-group" style="margin-top: 10px;">
						<li class="list-group-item"><span
							class="glyphicon glyphicon-wrench"></span><a href="index.html"> Common</a></li>
						<li class="list-group-item"><span
							class="glyphicon glyphicon-wrench"></span><a href="index.html"> Screen</a></li>
						<li class="list-group-item"><span
							class="glyphicon glyphicon-plus-sign"></span><a href="index.html"> Add New Group</a></li>
					</ul>
				</div></li>
			<li class="list-group-item"><span
				class="glyphicon glyphicon-plus"></span> gps2</li>
			<li class="list-group-item"><span
				class="glyphicon glyphicon-plus"></span> Third item</li>
		</ul>
	</div>

	<div id="overview" style="width: 700px; float: left">

<input type="hidden" name="connectionId" value=""/>
		<div class="form-group">
			<label for="name">Connection Name:</label> <input type="text"
				class="form-control" id="connectionname">
		</div>

		<div class="form-group">
			<label for="name">Host:</label> <input type="text"
				class="form-control" id="host">

		</div>

		<div class="form-group">
			<label for="name">Port:</label> <input type="text"
				class="form-control" id="port">

		</div>
		<div class="form-group">
			<label for="name">Username:</label> <input type="text"
				class="form-control" id="username">

		</div>

		<div class="form-group">
			<label for="name">PAssword:</label> <input type="text"
				class="form-control" id="Password">

		</div>

		<button type="button" name="saveLocalConnection" class="btn btn-default">
			<span class="glyphicon glyphicon-floppy-disk"></span> Save
		</button>
		<button type="button" name="deleteLocalConnection" class="btn btn-primary">
			<span class="glyphicon glyphicon-trash"></span> Delete
		</button>

	</div>
</body>

</html>