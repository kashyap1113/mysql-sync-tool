<html>
	<head>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

		<!-- jQuery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

		<!-- Latest compiled JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
		  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script
	src="./js/scipts.js"></script>		
		<script>
		var sConnectionId;
		
		$(document).ready(function() {
			genrateLeftSlidebar();
		    sConnectionId = getUrlParameter('connectionid');
			
			if(typeof sConnectionId  !== "undefined")
			{
				//$("input[name=""]").val(sConnectionId);
			}

			 var Tables = [
			      "ActionScript",
			      "AppleScript",
			      "Asp",
			      "BASIC",
			      "C",
			      "C++",
			      "Clojure",
			      "COBOL",
			      "ColdFusion",
			      "Erlang",
			      "Fortran",
			      "Groovy",
			      "Haskell",
			      "Java",
			      "JavaScript",
			      "Lisp",
			      "Perl",
			      "PHP",
			      "Python",
			      "Ruby",
			      "Scala",
			      "Scheme"
			    ];
			 
			    $( "#tableInput" ).autocomplete({
			      source: Tables,
			      select: function(event, ui) {
			    	  	var sTableName=ui.item.value;
			    	  	var tableAllreadyAvailable=($("tr[name='group-table'][tablename='"+ sTableName  +"']").length>0)?true:false;
			    	  	
			    	  	if(tableAllreadyAvailable!=true){
			    	  		 var htmlRow = '<tr name="group-table" tablename="'+ ui.item.value +'"><td name="tablename">'+ ui.item.value +'</td><td name="schemaCheck"><input name="schema" type="checkbox"></td><td name="dataCheck"><input name="data" type="checkbox"></td></tr>';
			                    $('#group-tables').append(htmlRow);
			                    $( "#tableInput" ).val(""); 	
			    	  	}
			    	  	else{
			    	  		alert("table already availble");
			    	  	}	                  
	                }
			    });
		});
		
		
		$(document).on("click","button[name='save-group']",function(){
			var sGroupName=$("#GroupName").val();
			alert(sGroupName);
			var sTableName;
			var sIsSchema;
			var sIsData;
			var sTablesJsonRequestInput="";
			var itr=0;
			alert($("tr[name='group-table']").length);
			$("tr[name='group-table']").each(function(){
			
				sTableName=$(this).find("td[name='tablename']").text();
				sIsSchema=($(this).find("td[name='schemaCheck']").find("input").is("checked")==true)?"TRUE":"FALSE";
				sIsData=($(this).find("td[name='dataCheck']").find("input").is("checked")==true)?"TRUE":"FALSE";
				if(itr==0){
					sTablesJsonRequestInput+="{'tableName':'"+ sTableName +"','isSchema':'"+ sIsSchema +"','isData':'"+ sIsData +"'}";	
				}
				else{
					sTablesJsonRequestInput+=",{'tableName':'"+ sTableName +"','isSchema':'"+ sIsSchema +"','isData':'"+ sIsData +"'}";
				}
				itr++;	
			});
			var sJsonRequest="{ 'connectionId':'"+ sConnectionId +"','groupName':'"+ sGroupName +"',tables=["+ sTablesJsonRequestInput +"] }";
			
			console.log(sJsonRequest);
			
			$.ajax({
				type : "post",
				url : "databaseoperations.do",
				data : "type=insertConnectionGroup&values="+ sJsonRequest,
				success : function(response) {
					alert(response);
				},
				dataType : 'text'
				});
			
		});
		
		
		</script>
		<style>
 .connection_group{
	margin-top: 10px;
	margin-left: 10px;
 }
 
 .local_group_name{
	cursor:pointer;
 }
 
 [name="group-names"]{
	display:none;
 }
 
 span[name="collapse"]{
	cursor:pointer;
 }
 
 span[name="edit-connection"]{
	cursor:pointer;
 }
</style>
		
		
	</head>
	
	<body style="margin:10px;" >
	
		<div id="menu" style="width: 300px; float: left; margin-right: 50px">
		<h4>Local Database</h4>
		<ul name="leftSlideBar" class="list-group">
		
			<li class="list-group-item">
				<div class="group_operation">
				
				<span data-toggle="collapse"
					data-target="#gps_group" class="glyphicon glyphicon-plus" name="collapse"></span><a href="localconnection.html"><span
					class="glyphicon glyphicon-wrench" name="edit-connection"></span></a> gps
				</div>			
			<div id="gps_group" class="connection_group collapse">
					<div class="local_group_name">
						<span class="glyphicon glyphicon-folder-close"></span> Groups 
					</div>
					
					<ul  name="group-names" class="list-group" style="margin-top: 10px;">
						<li class="list-group-item"><span
							class="glyphicon glyphicon-wrench"></span><a href="index.html"> Common</a></li>
						<li class="list-group-item"><span
							class="glyphicon glyphicon-wrench"></span><a href="index.html"> Screen</a></li>
						<li class="list-group-item"><span
							class="glyphicon glyphicon-plus-sign"></span><a href="index.html"> Add New Group</a></li>
					</ul>
				</div></li>
			<li class="list-group-item"><span
				class="glyphicon glyphicon-plus"></span> gps2</li>
			<li class="list-group-item"><span
				class="glyphicon glyphicon-plus"></span> Third item</li>
		</ul>
	</div>	
			<div id="overview" style="width:700px;float:left">
			
			
			<div class="form-group">
				<label for="name">Group Name:</label>
				<input type="text" class="form-control" id="GroupName">
			</div>
			
			<div class="form-group">
				<label for="name">Choose Table:</label>
				<input type="text" class="form-control" id="tableInput">
			</div>
			
			
			<div class="form-group">
			
				 <table class="table table-striped" id="group-tables">
					<thead>
					  <tr>
						<th>Table</th>
						<th>Scheme</th>
						<th>Data</th>
					  </tr>
					</thead>
					<tbody>
					 
					</tbody>
				  </table>
				<br/>
				<button name="save-group" type="button" class="btn btn-default"><span class="glyphicon glyphicon-floppy-disk"></span> Save</button>
				 <button type="button" class="btn btn-primary"><span class="glyphicon glyphicon-trash"></span> Delete</button>
			</div>
			
			</div>
	</body>

</html>